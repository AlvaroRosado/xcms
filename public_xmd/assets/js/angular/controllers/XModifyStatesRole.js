// Generated by CoffeeScript 1.8.0
angular.module("ximdex.main.controller").controller("XModifyStatesRoleCtrl", [
  "$scope", "$http", "xUrlHelper", "$timeout", function($scope, $http, xUrlHelper, $timeout) {
    var url = xUrlHelper.getAction({
    	action: 'modifystatesrole',
    	method: 'update_states'
    });
    return $scope.saveChanges = function()
    {
	  $scope.loading = true;
	  var petition = $http.post(url, {
		  workflows: $scope.workflows,
		  idRole: $scope.idRole
	  });
	  petition.success(function(data, status, headers, config) {
	    $scope.loading = false;
	    if (data.message !== "") {
	    	$scope.messageClass = data.result === "ok" ? "message-success" : "message-error";
	    	$scope.thereAreMessages = true;
	    	$scope.message = data.message;
	    	return $timeout(function() {
	    		$scope.thereAreMessages = false;
	    		return $timeout(function() {
	    			return $scope.message = "";
	    		}, 500);
	    	}, 2000);
	    }
	  });
	  return petition.error(function(data, status, headers, config) {
		  return $scope.loading = false;
	  });
    };
  }
]);
